(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/htz-image-upload/htz-image-upload"],{"1bc4":function(e,t,i){"use strict";var n=i("500e"),a=i.n(n);a.a},"21ac":function(e,t,i){"use strict";i.r(t);var n=i("762c"),a=i("dd20");for(var o in a)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(o);i("f32a"),i("1bc4");var u=i("828b"),s=Object(u["a"])(a["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);t["default"]=s.exports},"500e":function(e,t,i){},"762c":function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return n}));var n={uIcon:function(){return i.e("uview-ui/components/u-icon/u-icon").then(i.bind(null,"32bb"))}},a=function(){var e=this,t=e.$createElement,i=(e._self._c,e.__map(e.uploadLists,(function(t,i){var n=e.__get_orig(t),a=2===t.type?t.url.split("/").pop():null,o=2!==t.type?e.isVideo(t):null,u=2!==t.type&&o?e.getFileUrl(t):null,s=2!==t.type&&o?e.getFileUrl(t):null,c=2===t.type||o?null:e.getFileUrl(t),r=2===t.type||o?null:e.getFileUrl(t);return{$orig:n,g0:a,m0:o,m1:u,m2:s,m3:c,m4:r}}))),n=e.uploadLists.length<e.max&&e.add;e.$mp.data=Object.assign({},{$root:{l0:i,g1:n}})},o=[]},c819:function(e,t,i){},dd20:function(e,t,i){"use strict";i.r(t);var n=i("f0ab"),a=i.n(n);for(var o in n)["default"].indexOf(o)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(o);t["default"]=a.a},f0ab:function(e,t,i){"use strict";(function(e,n,a){var o=i("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var u=o(i("7ca3"));function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}var c={name:"htz-image-upload",props:{max:{type:Number,default:1},chooseNum:{type:Number,default:9},name:{type:String,default:"file"},dataType:{type:Number,default:0},remove:{type:Boolean,default:!0},add:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},sourceType:{type:Array,default:function(){return["album","camera"]}},action:{type:String,default:""},headers:{type:Object,default:function(){}},formData:{type:Object,default:function(){}},compress:{type:Boolean,default:!0},quality:{type:Number,default:80},value:{type:Array,default:function(){return[]}},uploadSuccess:{default:function(e){return{success:!1,url:""}}},mediaType:{type:String,default:"image"},maxDuration:{type:Number,default:60},camera:{type:String,default:"back"},appVideoPoster:{type:String,default:"/static/htz-image-upload/play.png"}},data:function(){return{uploadLists:[],mediaTypeData:["image","video","all","file"],previewVideoSrc:""}},mounted:function(){this.$nextTick((function(){this.uploadLists=this.value,-1==this.mediaTypeData.indexOf(this.mediaType)&&e.showModal({title:"提示",content:"mediaType参数不正确",showCancel:!1,success:function(e){e.confirm||e.cancel}})}))},watch:{value:function(e,t){this.uploadLists=e}},methods:{isVideo:function(e){var t=!1;return(!/.(gif|jpg|jpeg|png|gif|jpg|png)$/i.test(e)&&0==this.dataType||1==this.dataType&&1==e.type)&&(t=!0),t},getFileUrl:function(e){var t=e;return 1==this.dataType&&(t=e.url),t},previewVideo:function(e){this.previewVideoSrc=e},previewVideoClose:function(){this.previewVideoSrc=""},imgDel:function(t){var i=this;e.showModal({title:"提示",content:"您确定要删除么?",success:function(e){if(e.confirm){var n=i.uploadLists[t];i.uploadLists.splice(t,1),i.$emit("input",i.uploadLists),i.$emit("imgDelete",{del:n,tempFilePaths:i.uploadLists})}else e.cancel}})},imgPreview:function(t){var i=this,n=[];this.uploadLists.forEach((function(e){i.isVideo(e)||n.push(i.getFileUrl(e))})),e.previewImage({urls:n,current:t,loop:!0})},chooseFile:function(){var t=this;if(this.disabled)return!1;switch(this.mediaTypeData.indexOf(this.mediaType)){case 1:this.videoAdd();break;case 2:e.showActionSheet({itemList:["相册","视频"],success:function(e){1==e.tapIndex?t.videoAdd():0==e.tapIndex&&t.imgAdd()},fail:function(e){}});break;case 3:this.FileAdd();break;default:this.imgAdd();break}},FileAdd:function(){var e=this,t=Math.abs(this.uploadLists.length-this.max),i=this.chooseNum>t?t:this.chooseNum;n.chooseMessageFile({count:i,type:"file",success:function(t){var i=t.tempFiles.map((function(e){return e.path}));e.chooseSuccessMethod(i,2)}})},videoAdd:function(){var t=this,i=Math.abs(this.uploadLists.length-this.max);this.chooseNum>i||this.chooseNum;e.chooseVideo({compressed:this.compress,sourceType:this.sourceType,camera:this.camera,maxDuration:this.maxDuration,success:function(e){t.chooseSuccessMethod([e.tempFilePath],1)}})},imgAdd:function(){var t=this,i=Math.abs(this.uploadLists.length-this.max),n=this.chooseNum>i?i:this.chooseNum;e.chooseImage({count:n,sizeType:["original","compressed"],sourceType:this.sourceType,success:function(e){t.chooseSuccessMethod(e.tempFilePaths,0)}})},appCamera:function(){var e=this,t=plus.camera.getCamera(),i=t.supportedImageResolutions[0],n=t.supportedImageFormats[0];t.captureImage((function(t){e.chooseSuccessMethod([t],0)}),(function(e){}),{resolution:i,format:n})},appGallery:function(e){var t=this;plus.gallery.pick((function(e){t.chooseSuccessMethod(e.files,0)}),(function(e){}),{filter:"image",multiple:!0,maximum:e})},chooseSuccessMethod:function(e,t){""==this.action?this.$emit("chooseSuccess",e,t):1==t||2==t?this.imgUpload(e,t):this.compress?this.imgCompress(e,t):this.imgUpload(e,t)},imgCompress:function(t,i){var n=this;e.showLoading({title:"压缩中..."});var a=[],o=[];t.forEach((function(t,i){a.push(new Promise((function(i,a){e.compressImage({src:t,quality:n.quality,success:function(e){o.push(e.tempFilePath),i(e.tempFilePath)},fail:function(e){a(e)},complete:function(){}})})))})),Promise.all(a).then((function(t){e.hideLoading(),n.imgUpload(t,i)})).catch((function(t,i){e.hideLoading()}))},imgUpload:function(t,i){var n=this;if("uniCloud"!=this.action){e.showLoading({title:"上传中"});var a=[];t.forEach((function(t,o){a.push(new Promise((function(a,o){e.uploadFile({url:n.action,filePath:t,name:n.name,fileType:"image",formData:n.formData,header:n.headers,success:function(e){if(e.fileType=i,"function"==typeof n.uploadSuccess){var t=n.uploadSuccess(e);if(t.success){"value",0==n.dataType?n["value"].push(t.url):n["value"].push(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach((function(t){(0,u.default)(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({type:i,url:t.url},t)),n.$emit("input",n.uploadLists)}}a(e),n.$emit("uploadSuccess",e)},fail:function(e){o(e),n.$emit("uploadFail",e)},complete:function(){}})})))})),Promise.all(a).then((function(t){e.hideLoading()})).catch((function(t,i){e.hideLoading(),n.$emit("uploadFail",t)}))}else this.uniCloudUpload(t,i)},uniCloudUpload:function(t,i){var n=this;e.showLoading({title:"上传中"});var o=[];t.forEach((function(e,t){o.push(new Promise((function(t,o){a.uploadFile({filePath:e,cloudPath:n.guid()+"."+n.getFileType(e,i),success:function(e){e.success&&t(e.fileID)},fail:function(e){o(e)},complete:function(){}})})))})),Promise.all(o).then((function(t){e.hideLoading(),a.getTempFileURL({fileList:t,success:function(e){e.fileList.forEach((function(e){n.value.push(e.tempFileURL),n.$emit("input",n.value)}))},fail:function(){},complete:function(){}})})).catch((function(t,i){e.hideLoading()}))},getFileType:function(e,t){var i=e.split(".").pop().toLowerCase();return this.compress&&(i=0==t?"jpg":"mp4"),i},guid:function(){return"xxxxxxxx-date-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;return i.toString(16)})).replace(/date/g,(function(e){return Date.parse(new Date)}))},canvasDataURL:function(e,t,i){var n=new Image;n.src=e,n.onload=function(){var e=this.width,n=this.height,a=e/n;e=t.width||e,n=t.height||e/a;var o=.8,u=document.createElement("canvas"),s=u.getContext("2d"),c=document.createAttribute("width");c.nodeValue=e;var r=document.createAttribute("height");r.nodeValue=n,u.setAttributeNode(c),u.setAttributeNode(r),s.drawImage(this,0,0,e,n),t.quality&&t.quality<=1&&t.quality>0&&(o=t.quality);var l=u.toDataURL("image/jpeg",o);i(l)}},pickExclude:function(e,t){return["[object Object]","[object File]"].includes(Object.prototype.toString.call(e))?Object.keys(e).reduce((function(i,n){return t.includes(n)||(i[n]=e[n]),i}),{}):{}}}};t.default=c}).call(this,i("df3c")["default"],i("3223")["default"],i("861b")["default"])},f32a:function(e,t,i){"use strict";var n=i("c819"),a=i.n(n);a.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/htz-image-upload/htz-image-upload-create-component',
    {
        'components/htz-image-upload/htz-image-upload-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('df3c')['createComponent'](__webpack_require__("21ac"))
        })
    },
    [['components/htz-image-upload/htz-image-upload-create-component']]
]);
